---
const { selectedItem } = Astro.props;
---

<aside
  id="sidebar"
  data-animation="default"
  data-collapse="medium"
  data-duration="400"
  data-easing="ease"
  data-easing2="ease"
  role="banner"
  class="sidebar w-nav"
  transition:persist="sidebar"
>
  <div class="nav-content">
    <a href="/" class="w-nav-brand" aria-label="home">
      <div class="niv-data">
        <div>
          <div class="label-white">Baraa Nazar</div>
          <div class="label-gray">Frontend Engineer</div>
        </div>
      </div>
    </a>

    <nav role="navigation" class="w-nav-menu">
      <a
        href="/"
        class={`nav-link-container w-inline-block ${
          selectedItem === 'home' ? 'w--current' : ''
        }`}
      >
        <img
          src="/assets/home.svg"
          loading="eager"
          alt=""
          class="nav-link-image"
        />
        <div>Home</div>
      </a>
      <a
        href="/software-development"
        class={`nav-link-container w-inline-block ${
          selectedItem === 'software-development' ? 'w--current' : ''
        }`}
        aria-current={
          selectedItem === 'software-development' ? 'page' : undefined
        }
      >
        <img
          src="/assets/code.svg"
          loading="eager"
          alt=""
          class="nav-link-image"
        />
        <div>Software development</div>
      </a>
      <a
        href="/personal-projects"
        class={`nav-link-container w-inline-block ${
          selectedItem === 'personal-projects' ? 'w--current' : ''
        }`}
      >
        <img
          src="/assets/favorite.svg"
          loading="eager"
          alt=""
          class="nav-link-image"
        />
        <div>Personal projects</div>
      </a>
      <a
        href="/articles"
        class={`nav-link-container w-inline-block ${
          selectedItem === 'articles' ? 'w--current' : ''
        }`}
      >
        <img
          src="/assets/browser.svg"
          loading="eager"
          alt=""
          class="nav-link-image"
        />
        <div>Articles</div>
      </a>
      <a
        href="/notes"
        class={`nav-link-container w-inline-block ${
          selectedItem === 'notes' ? 'w--current' : ''
        }`}
      >
        <img
          src="/assets/database.svg"
          loading="eager"
          alt=""
          class="nav-link-image"
        />
        <div>Notes</div>
      </a>
      <a
        href="/about"
        class={`nav-link-container w-inline-block ${
          selectedItem === 'about' ? 'w--current' : ''
        }`}
      >
        <img
          src="/assets/code.svg"
          loading="eager"
          alt=""
          class="nav-link-image"
        />
        <div>About</div>
      </a>
    </nav>

    <div style="margin-top: auto; padding-top: 24px; border-top: 1px solid #353535;">
      <div class="mini-label-white" style="margin-top: 0; margin-bottom: 12px;">Contact</div>
      <div class="label-gray" style="margin-bottom: 8px;">Erbil, Iraq</div>
      <a href="mailto:baraa.nazar.ph@gmail.com" class="label-gray" style="text-decoration: none; display: block; margin-bottom: 8px;">baraa.nazar.ph@gmail.com</a>
      <a href="tel:+9647739009009" class="label-gray" style="text-decoration: none; display: block; margin-bottom: 12px;">+9647739009009</a>
      <div style="display: flex; gap: 8px; align-items: center;">
        <a href="https://github.com/BaraaNazar" target="_blank" rel="noopener noreferrer" class="label-gray" style="text-decoration: none;">GitHub</a>
        <span class="label-gray">|</span>
        <a href="https://www.linkedin.com/in/baraa-nazar-a29226138/" target="_blank" rel="noopener noreferrer" class="label-gray" style="text-decoration: none;">LinkedIn</a>
      </div>
    </div>

    <div
      class="navbar-icon-button w-nav-button"
      style="-webkit-user-select: text;"
      aria-label="menu"
      role="button"
      tabindex="0"
    >
      <img
        src="/assets/menu.svg"
        loading="eager"
        alt=""
        class="navbar-icon"
      />
    </div>
  </div>

  <script>
    import { setupNav } from '../scripts/nav.js';
    
    const updateActiveState = () => {
      const currentPath = window.location.pathname;
      const navLinks = document.querySelectorAll('.nav-link-container');
      
      navLinks.forEach(link => {
        const href = link.getAttribute('href');
        if (href === currentPath || (currentPath === '/' && href === '/')) {
          link.classList.add('w--current');
        } else {
          link.classList.remove('w--current');
        }
      });
    };
    
    let cleanup;
    document.addEventListener('astro:page-load', () => {
      updateActiveState();
      if (cleanup) cleanup();
      cleanup = setupNav();
    });

    document.addEventListener('astro:before-swap', () => {
      if (cleanup) cleanup();
    });
    
    // Update on initial load
    if (document.readyState === 'loading') {
      document.addEventListener('DOMContentLoaded', updateActiveState);
    } else {
      updateActiveState();
    }
  </script>
</aside>
